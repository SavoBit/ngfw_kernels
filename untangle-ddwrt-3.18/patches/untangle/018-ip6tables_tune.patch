diff -urN source_untangle.orig/include/net/netns/ipv6.h source_untangle/include/net/netns/ipv6.h
--- source_untangle.orig/include/net/netns/ipv6.h	2015-05-13 02:57:54.093897191 -0600
+++ source_untangle/include/net/netns/ipv6.h	2015-05-13 03:00:00.753894618 -0600
@@ -43,6 +43,7 @@
 	struct xt_table		*ip6table_filter;
 	struct xt_table		*ip6table_mangle;
 	struct xt_table		*ip6table_raw;
+	struct xt_table		*ip6table_tune;
 #ifdef CONFIG_SECURITY
 	struct xt_table		*ip6table_security;
 #endif
diff -urN source_untangle.orig/include/uapi/linux/netfilter_ipv6.h source_untangle/include/uapi/linux/netfilter_ipv6.h
--- source_untangle.orig/include/uapi/linux/netfilter_ipv6.h	2015-05-13 02:57:54.069897191 -0600
+++ source_untangle/include/uapi/linux/netfilter_ipv6.h	2015-05-13 11:05:00.017303409 -0600
@@ -72,6 +72,7 @@
 	NF_IP6_PRI_NAT_SRC = 100,
 	NF_IP6_PRI_SELINUX_LAST = 225,
 	NF_IP6_PRI_CONNTRACK_HELPER = 300,
+        NF_IP6_PRI_TUNE = INT_MAX - 5,
 	NF_IP6_PRI_LAST = INT_MAX,
 };
 
diff -urN source_untangle.orig/net/ipv6/netfilter/ip6table_tune.c source_untangle/net/ipv6/netfilter/ip6table_tune.c
--- source_untangle.orig/net/ipv6/netfilter/ip6table_tune.c	1969-12-31 17:00:00.000000000 -0700
+++ source_untangle/net/ipv6/netfilter/ip6table_tune.c	2015-05-13 14:10:52.449076826 -0600
@@ -0,0 +1,95 @@
+/* 
+ * 
+ * (C) 2015 David Han <dhan@untangle.com>
+ *
+ * Port IPv4 tune table to support IPv6
+ */
+
+#include <linux/module.h>
+#include <linux/netfilter.h>
+#include <linux/netfilter_ipv6.h>
+#include <linux/netfilter_ipv6/ip6_tables.h>
+#include <linux/ip.h>
+#include <net/ip.h>
+
+#define TUNE_VALID_HOOKS ((1 << NF_INET_POST_ROUTING) | (1 << NF_INET_LOCAL_OUT))
+
+static struct nf_hook_ops *tune_ops __read_mostly;
+
+static const struct xt_table packet_tuner = {
+	.name		= "tune",
+	.valid_hooks	= TUNE_VALID_HOOKS,
+	.me		= THIS_MODULE,
+	.af		= NFPROTO_IPV6,
+	.priority = NF_IP6_PRI_TUNE,
+};
+
+static unsigned int
+ip6table_tune_hook(const struct nf_hook_ops *ops, struct sk_buff *skb,
+		 const struct net_device *in, const struct net_device *out,
+		 int (*okfn)(struct sk_buff *))
+{
+	const struct net *net;
+	net = dev_net(out);
+
+	if (ops->hooknum == NF_INET_LOCAL_OUT &&
+		(skb->len < sizeof(struct iphdr) ||
+		 ip_hdrlen(skb) < sizeof(struct iphdr)))
+		return NF_ACCEPT;
+	
+	net = dev_net(out);
+	return ip6t_do_table(skb, ops->hooknum, in, out, net->ipv6.ip6table_tune);
+}
+
+
+static int __net_init ip6table_tune_net_init(struct net *net)
+{
+	struct ip6t_replace *repl;
+
+	repl = ip6t_alloc_initial_table(&packet_tuner);
+	if (repl == NULL)
+		return -ENOMEM;
+
+	net->ipv6.ip6table_tune = ip6t_register_table(net, &packet_tuner, repl);
+	kfree(repl);
+	return PTR_ERR_OR_ZERO(net->ipv6.ip6table_tune);
+}
+
+static void __net_exit ip6table_tune_net_exit(struct net *net)
+{
+	ip6t_unregister_table(net, net->ipv6.ip6table_tune);
+}
+
+static struct pernet_operations ip6table_tune_net_ops = {
+	.init	= ip6table_tune_net_init,
+	.exit	= ip6table_tune_net_exit,
+};
+
+static int __init ip6table_tune_init(void)
+{
+	int ret;
+
+	ret = register_pernet_subsys(&ip6table_tune_net_ops);
+	if (ret < 0)
+		return ret;
+
+	/* Register hooks */
+	tune_ops = xt_hook_link(&packet_tuner, ip6table_tune_hook);
+	if (IS_ERR(tune_ops)) {
+		ret = PTR_ERR(tune_ops);
+		unregister_pernet_subsys(&ip6table_tune_net_ops);
+	}
+
+	return ret;
+}
+
+static void __exit ip6table_tune_exit(void)
+{
+	xt_hook_unlink(&packet_tuner, tune_ops);
+	unregister_pernet_subsys(&ip6table_tune_net_ops);
+}
+
+module_init(ip6table_tune_init);
+module_exit(ip6table_tune_exit);
+
+MODULE_LICENSE("GPL");
diff -urN source_untangle.orig/net/ipv6/netfilter/Kconfig source_untangle/net/ipv6/netfilter/Kconfig
--- source_untangle.orig/net/ipv6/netfilter/Kconfig	2015-05-13 02:57:54.833897176 -0600
+++ source_untangle/net/ipv6/netfilter/Kconfig	2015-05-13 14:15:15.245071486 -0600
@@ -216,6 +216,19 @@
 	  If you want to compile it as a module, say M here and read
 	  <file:Documentation/kbuild/modules.txt>.  If unsure, say `N'.
 
+config IP6_NF_TUNE
+       tristate  'tune table support (adds a chain after POSTROUTING nat)'
+       depends on IP6_NF_IPTABLES
+       help
+         This option adds a `tune' table to iptables. This table is the very
+         last in the netfilter framework and hooks in at the POSTROUTING
+         chain.
+       
+         If you want to compile it as a module, say M here and read
+         <file:Documentation/modules.txt>.  If unsure, say `N'.
+
+
+
 # security table for MAC policy
 config IP6_NF_SECURITY
        tristate "Security table"
diff -urN source_untangle.orig/net/ipv6/netfilter/Makefile source_untangle/net/ipv6/netfilter/Makefile
--- source_untangle.orig/net/ipv6/netfilter/Makefile	2015-05-13 02:57:54.833897176 -0600
+++ source_untangle/net/ipv6/netfilter/Makefile	2015-05-13 14:15:49.585070789 -0600
@@ -7,6 +7,7 @@
 obj-$(CONFIG_IP6_NF_FILTER) += ip6table_filter.o
 obj-$(CONFIG_IP6_NF_MANGLE) += ip6table_mangle.o
 obj-$(CONFIG_IP6_NF_RAW) += ip6table_raw.o
+obj-$(CONFIG_IP6_NF_TUNE) += ip6table_tune.o
 obj-$(CONFIG_IP6_NF_SECURITY) += ip6table_security.o
 obj-$(CONFIG_NF_NAT_IPV6) += ip6table_nat.o
 
