From 465b5055fc501e99bf5072198b2c108d64789638 Mon Sep 17 00:00:00 2001
From: Igor Grinberg <grinberg@compulab.co.il>
Date: Tue, 26 Feb 2013 18:35:45 +0200
Subject: ARM: i.MX6: cm-fx6: rename the USB init function

Use cm-fx6 specific USB initialization function.

Signed-off-by: Igor Grinberg <grinberg@compulab.co.il>
---
 arch/arm/mach-mx6/board-cm-fx6.c |   15 +++++++--------
 1 file changed, 7 insertions(+), 8 deletions(-)

diff --git a/arch/arm/mach-mx6/board-cm-fx6.c b/arch/arm/mach-mx6/board-cm-fx6.c
index 7ad4961..2962020 100644
--- a/arch/arm/mach-mx6/board-cm-fx6.c
+++ b/arch/arm/mach-mx6/board-cm-fx6.c
@@ -426,7 +426,7 @@ static void imx6_arm2_usbotg_vbus(bool on)
 		gpio_set_value(MX6_ARM2_USB_OTG_PWR, 0);
 }
 
-static void __init mx6_arm2_init_usb(void)
+static void __init cm_fx6_init_usb(void)
 {
 	int ret = 0;
 
@@ -435,13 +435,12 @@ static void __init mx6_arm2_init_usb(void)
 	/* disable external charger detect,
 	 * or it will affect signal quality at dp.
 	 */
+	ret = gpio_request_one(MX6_ARM2_USB_OTG_PWR,
+			       GPIOF_OUT_INIT_LOW, "usb-pwr");
+	if (ret)
+		pr_err("%s: USB_OTG_PWR gpio request failed: %d\n",
+		       __func__, ret);
 
-	ret = gpio_request(MX6_ARM2_USB_OTG_PWR, "usb-pwr");
-	if (ret) {
-		pr_err("failed to get GPIO MX6_ARM2_USB_OTG_PWR:%d\n", ret);
-		return;
-	}
-	gpio_direction_output(MX6_ARM2_USB_OTG_PWR, 0);
 	mxc_iomux_set_gpr_register(1, 13, 1, 1);
 
 	mx6_set_otghost_vbus_func(imx6_arm2_usbotg_vbus);
@@ -970,7 +969,7 @@ static void __init cm_fx6_init(void)
 		imx6q_add_ahci(0, &mx6_arm2_sata_data);
 
 	imx6q_add_vpu();
-	mx6_arm2_init_usb();
+	cm_fx6_init_usb();
 	platform_device_register(&arm2_vmmc_reg_devices);
 	mx6_cpu_regulator_init();
 
-- 
1.7.9.5

