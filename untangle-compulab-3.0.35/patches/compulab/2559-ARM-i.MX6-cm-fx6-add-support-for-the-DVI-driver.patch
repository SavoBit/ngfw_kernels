From 359b33ea7f7bf721ab3dac4521f764c78aefb085 Mon Sep 17 00:00:00 2001
From: Igor Grinberg <grinberg@compulab.co.il>
Date: Wed, 6 Mar 2013 15:49:54 +0200
Subject: ARM: i.MX6: cm-fx6: add support for the DVI driver

Add support for the DVI driver for cm-fx6.

Signed-off-by: Igor Grinberg <grinberg@compulab.co.il>
---
 arch/arm/mach-mx6/board-cm-fx6.c |   20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)

diff --git a/arch/arm/mach-mx6/board-cm-fx6.c b/arch/arm/mach-mx6/board-cm-fx6.c
index 8df0243..4c8a8c7 100644
--- a/arch/arm/mach-mx6/board-cm-fx6.c
+++ b/arch/arm/mach-mx6/board-cm-fx6.c
@@ -525,6 +525,20 @@ static struct at24_platform_data sb_fx6_eeprom_pdata = {
 };
 #endif
 
+#if defined(CONFIG_FB_MXC_EDID) || defined(CONFIG_FB_MXC_EDID_MODULE)
+static int cm_fx6_dvi_update(void)
+{
+	/* sb-fx6 - always connected */
+	return 1;
+}
+
+static struct fsl_mxc_dvi_platform_data cm_fx6_dvi_data = {
+	.ipu_id		= 0,
+	.disp_id	= 0,
+	.update		= cm_fx6_dvi_update,
+};
+#endif /* CONFIG_FB_MXC_EDID */
+
 static struct i2c_board_info cm_fx6_i2c0_board_info[] __initdata = {
 #if defined(CONFIG_GPIO_PCA953X) || defined(CONFIG_GPIO_PCA953X_MODULE)
 	{
@@ -553,6 +567,12 @@ static struct i2c_board_info cm_fx6_i2c1_board_info[] __initdata = {
 		I2C_BOARD_INFO("mxc_hdmi_i2c", 0x50),
 	},
 #endif
+#if defined(CONFIG_FB_MXC_EDID) || defined(CONFIG_FB_MXC_EDID_MODULE)
+	{	/* 0x7f - fake address, as sb-fx6 does not support DVI DDC */
+		I2C_BOARD_INFO("mxc_dvi", 0x7f),
+		.platform_data = &cm_fx6_dvi_data,
+	},
+#endif
 };
 
 #if defined(CONFIG_EEPROM_AT24) || defined(CONFIG_EEPROM_AT24_MODULE)
-- 
1.7.9.5

